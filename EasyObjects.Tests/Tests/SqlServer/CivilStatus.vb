
' Generated by MyGeneration Version # (1.2.0.2)

Imports System
Imports System.Data
Imports System.Data.Common
Imports Microsoft.Practices.EnterpriseLibrary.Data
Imports NCI.EasyObjects

Namespace EasyObjects.Tests.SQL

    Public Class CivilStatus
        Inherits _CivilStatus

        Public Sub New()
            Me.DefaultCommandType = CommandType.StoredProcedure
        End Sub

        Public Sub ResetTable()
            Dim formatTruncate As String = "TRUNCATE TABLE [{0}].[{1}];"
            Dim formatDeleteAll As String = "DELETE FROM [{0}].[{1}];"
            Dim resetIdentity As String = " DBCC CHECKIDENT([{1}], RESEED, 0);"
            Dim db As Database = GetDatabase()
            Dim sqlCommand As String = String.Format(formatTruncate + resetIdentity, Me.SchemaTableView, Me.TableName)
            Dim dbCommand As DbCommand = db.GetSqlStringCommand(sqlCommand)
            MyBase.LoadFromSqlNoExec(dbCommand)
        End Sub

    End Class

End Namespace
