
' Generated by MyGeneration Version # (1.2.0.2)

Imports System
Imports System.Data
Imports System.Data.Common
Imports Microsoft.Practices.EnterpriseLibrary.Data
Imports NCI.EasyObjects

NameSpace EasyObjects.Tests.SQL

Public Class AggregateTest 
	Inherits _AggregateTest

	Public Sub New()
		Me.DefaultCommandType = CommandType.StoredProcedure
	End Sub

        Public Overridable Function GetReaderAggregateTest() As IDataReader
            '  Create the Database object, using the default database service. The
            '  default database service is determined through configuration.
            Dim db As Database = GetDatabase()

            Dim sqlCommand As String = Me.SchemaStoredProcedureWithSeparator + "daab_GetAllAggregateTest"
            Dim dbCommand As DbCommand = db.GetSqlStringCommand(sqlCommand)

            ' Add procedure parameters

            Return MyBase.LoadFromSqlReader(dbCommand)
        End Function

        Public Overridable Function GetScalarAggregateTest() As Object
            '  Create the Database object, using the default database service. The
            '  default database service is determined through configuration.
            Dim db As Database = GetDatabase()

            Dim sqlCommand As String = "SELECT COUNT(*) FROM " + Me.SchemaTableViewWithSeparator + Me.TableName
            Dim dbCommand As DbCommand = db.GetSqlStringCommand(sqlCommand)

            ' Add procedure parameters

            Return MyBase.LoadFromSqlScalar(DbCommand)
        End Function

End Class

End NameSpace
