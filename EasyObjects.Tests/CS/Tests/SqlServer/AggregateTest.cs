
// Generated by MyGeneration Version # (1.1.6.0)

using System;
using System.Data;
using System.Data.Common;
using System.Collections.Specialized;	
using Microsoft.Practices.EnterpriseLibrary.Data;
using NCI.EasyObjects;

namespace NCI.EasyObjects.Tests.SQL
{
	public class AggregateTest : _AggregateTest
	{		
		public AggregateTest() {}
		
		public virtual IDataReader GetReaderAggregateTest ()
		{
			//  Create the Database object, using the default database service. The
			//  default database service is determined through configuration.
			Database db = GetDatabase();
			
			string sqlCommand = this.SchemaStoredProcedureWithSeparator + "daab_GetAllAggregateTest";
			DbCommand dbCommand = db.GetStoredProcCommand(sqlCommand);
			
			// Add procedure parameters

            return base.LoadFromSqlReader(dbCommand);
		} 
			
		public virtual object GetScalarAggregateTest ()
		{
			//  Create the Database object, using the default database service. The
			//  default database service is determined through configuration.
			Database db = GetDatabase();
			
			string sqlCommand = "SELECT COUNT(*) FROM " + this.SchemaTableViewWithSeparator + this.TableName;
            DbCommand dbCommand = db.GetSqlStringCommand(sqlCommand);
			
			// Add procedure parameters

            return base.LoadFromSqlScalar(dbCommand);
		}
	}
}
