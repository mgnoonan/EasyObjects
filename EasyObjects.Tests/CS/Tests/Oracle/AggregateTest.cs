
// Generated by MyGeneration Version # (1.1.5.1)

using System;
using System.Data;
using System.Collections.Specialized;	
using Microsoft.Practices.EnterpriseLibrary.Data;
using NCI.EasyObjects;

namespace NCI.EasyObjects.Tests.Oracle
{
	public class AggregateTest : _AggregateTest
	{		
		public AggregateTest() {}
		
		public virtual IDataReader GetReaderAggregateTest ()
		{
			//  Create the Database object, using the default database service. The
			//  default database service is determined through configuration.
			Database db = GetDatabase();
			
			string sqlCommand = this.SchemaStoredProcedureWithSeparator + "daab_GetAllAggregateTest";
			DBCommandWrapper dbCommandWrapper = db.GetStoredProcCommandWrapper(sqlCommand);
			
			// Add procedure parameters

			return base.LoadFromSqlReader(dbCommandWrapper);
		} 
			
		public virtual object GetScalarAggregateTest ()
		{
			//  Create the Database object, using the default database service. The
			//  default database service is determined through configuration.
			Database db = GetDatabase();
			
			string sqlCommand = "SELECT COUNT(*) FROM " + this.SchemaTableViewWithSeparator + this.TableName;
			DBCommandWrapper dbCommandWrapper = db.GetSqlStringCommandWrapper(sqlCommand);
			
			// Add procedure parameters

			return base.LoadFromSqlScalar(dbCommandWrapper);
		}
	}
}
